<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Analysis of TI | CytoTree Tutorial</title>
  <meta name="description" content="This is the tutorial of CytoTree R/Biocondcutor package." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Analysis of TI | CytoTree Tutorial" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the tutorial of CytoTree R/Biocondcutor package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Analysis of TI | CytoTree Tutorial" />
  
  <meta name="twitter:description" content="This is the tutorial of CytoTree R/Biocondcutor package." />
  

<meta name="author" content="Yuting Dai" />


<meta name="date" content="2020-11-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ti.html"/>
<link rel="next" href="time-course-data-use-case.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/JhuangLab/CytoTree"><center><b>CytoTree</b></center></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="quick-start.html"><a href="quick-start.html"><i class="fa fa-check"></i><b>2</b> Quick Start</a>
<ul>
<li class="chapter" data-level="2.1" data-path="quick-start.html"><a href="quick-start.html#overview-of-workflow"><i class="fa fa-check"></i><b>2.1</b> Overview of Workflow</a></li>
<li class="chapter" data-level="2.2" data-path="quick-start.html"><a href="quick-start.html#installation"><i class="fa fa-check"></i><b>2.2</b> Installation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="quick-start.html"><a href="quick-start.html#github"><i class="fa fa-check"></i><b>2.2.1</b> GitHub</a></li>
<li class="chapter" data-level="2.2.2" data-path="quick-start.html"><a href="quick-start.html#bioconductor"><i class="fa fa-check"></i><b>2.2.2</b> Bioconductor</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="quick-start.html"><a href="quick-start.html#quick-start-code"><i class="fa fa-check"></i><b>2.3</b> Quick-start code</a></li>
<li class="chapter" data-level="2.4" data-path="quick-start.html"><a href="quick-start.html#visualization"><i class="fa fa-check"></i><b>2.4</b> Visualization</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ti.html"><a href="ti.html"><i class="fa fa-check"></i><b>3</b> Trajectory Inference (TI)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ti.html"><a href="ti.html#preprocessing"><i class="fa fa-check"></i><b>3.1</b> Preprocessing</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="ti.html"><a href="ti.html#preprocessing-using-flowcore"><i class="fa fa-check"></i><b>3.1.1</b> Preprocessing using <code>flowCore</code></a></li>
<li class="chapter" data-level="3.1.2" data-path="ti.html"><a href="ti.html#preprocessing-using-cytotree"><i class="fa fa-check"></i><b>3.1.2</b> Preprocessing using <code>CytoTree</code></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ti.html"><a href="ti.html#clustering"><i class="fa fa-check"></i><b>3.2</b> Clustering</a></li>
<li class="chapter" data-level="3.3" data-path="ti.html"><a href="ti.html#dimensionality-reduction"><i class="fa fa-check"></i><b>3.3</b> Dimensionality Reduction</a></li>
<li class="chapter" data-level="3.4" data-path="ti.html"><a href="ti.html#build-trajectory"><i class="fa fa-check"></i><b>3.4</b> Build Trajectory</a></li>
<li class="chapter" data-level="3.5" data-path="ti.html"><a href="ti.html#optimization"><i class="fa fa-check"></i><b>3.5</b> Optimization</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>4</b> Analysis of TI</a>
<ul>
<li class="chapter" data-level="4.1" data-path="analysis.html"><a href="analysis.html#pseudotime"><i class="fa fa-check"></i><b>4.1</b> Pseudotime</a></li>
<li class="chapter" data-level="4.2" data-path="analysis.html"><a href="analysis.html#intermediate-states"><i class="fa fa-check"></i><b>4.2</b> Intermediate States</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="time-course-data-use-case.html"><a href="time-course-data-use-case.html"><i class="fa fa-check"></i><b>5</b> Time-course data use case</a>
<ul>
<li class="chapter" data-level="5.1" data-path="time-course-data-use-case.html"><a href="time-course-data-use-case.html#step-1.-preprocessing"><i class="fa fa-check"></i><b>5.1</b> Step 1. Preprocessing</a></li>
<li class="chapter" data-level="5.2" data-path="time-course-data-use-case.html"><a href="time-course-data-use-case.html#step-2.-trajectory"><i class="fa fa-check"></i><b>5.2</b> Step 2. Trajectory</a></li>
<li class="chapter" data-level="5.3" data-path="time-course-data-use-case.html"><a href="time-course-data-use-case.html#step-3.-pseudotime"><i class="fa fa-check"></i><b>5.3</b> Step 3. Pseudotime</a></li>
<li class="chapter" data-level="5.4" data-path="time-course-data-use-case.html"><a href="time-course-data-use-case.html#step-4.-subset-cyt"><i class="fa fa-check"></i><b>5.4</b> Step 4. Subset CYT</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="advanced-usage.html"><a href="advanced-usage.html"><i class="fa fa-check"></i><b>6</b> Advanced Usage</a>
<ul>
<li class="chapter" data-level="6.1" data-path="advanced-usage.html"><a href="advanced-usage.html#fetch-meta-data"><i class="fa fa-check"></i><b>6.1</b> Fetch meta data</a></li>
<li class="chapter" data-level="6.2" data-path="advanced-usage.html"><a href="advanced-usage.html#add-meta-data"><i class="fa fa-check"></i><b>6.2</b> Add meta data</a></li>
<li class="chapter" data-level="6.3" data-path="advanced-usage.html"><a href="advanced-usage.html#fetch-cells"><i class="fa fa-check"></i><b>6.3</b> Fetch cells</a></li>
<li class="chapter" data-level="6.4" data-path="advanced-usage.html"><a href="advanced-usage.html#subset-object"><i class="fa fa-check"></i><b>6.4</b> Subset object</a></li>
<li class="chapter" data-level="6.5" data-path="advanced-usage.html"><a href="advanced-usage.html#batch-effect"><i class="fa fa-check"></i><b>6.5</b> Batch effect</a></li>
<li class="chapter" data-level="6.6" data-path="advanced-usage.html"><a href="advanced-usage.html#change-markers"><i class="fa fa-check"></i><b>6.6</b> Change markers</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="structure-of-cytotree.html"><a href="structure-of-cytotree.html"><i class="fa fa-check"></i><b>7</b> Structure of CytoTree</a></li>
<li class="chapter" data-level="8" data-path="about-cytotree.html"><a href="about-cytotree.html"><i class="fa fa-check"></i><b>8</b> About CytoTree</a>
<ul>
<li class="chapter" data-level="" data-path="about-cytotree.html"><a href="about-cytotree.html#bug-reports"><i class="fa fa-check"></i>Bug Reports</a></li>
<li class="chapter" data-level="" data-path="about-cytotree.html"><a href="about-cytotree.html#current-version"><i class="fa fa-check"></i>Current version</a></li>
<li class="chapter" data-level="" data-path="about-cytotree.html"><a href="about-cytotree.html#acknowledgment"><i class="fa fa-check"></i>Acknowledgment</a></li>
<li class="chapter" data-level="" data-path="about-cytotree.html"><a href="about-cytotree.html#session-information"><i class="fa fa-check"></i>Session Information</a></li>
<li class="chapter" data-level="" data-path="about-cytotree.html"><a href="about-cytotree.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="about-cytotree.html"><a href="about-cytotree.html#about-the-author"><i class="fa fa-check"></i>About The Author</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CytoTree Tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analysis" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Analysis of TI</h1>
<p>This chapter will show you the feature extraction and cell state refinement, including pseudotime estimation and intermediate state cell analysis.</p>
<div id="pseudotime" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Pseudotime</h2>
<p>In this part, we will use the CYT object generated in Trajectory Inference chapter <a href="ti.html#ti">3</a>.</p>
<p>The algorithm used to estimate pseudotime was based on prior knowledge derivation. The steps to estimate pseudotime could be divided into four parts.</p>
<p>Step 1, the definition of root cells. A root cell was the initiation site of differentiation or the start point of the biological process. The pseudotime in root cells was first set up to zero.</p>
<p>Step 2, construction of the graph to connect all cells using the k-nearest neighbors (KNN) algorithm.</p>
<p>Step 3, calculation of the distance from root cells to all other cells by shortest paths.</p>
<p>Step 4, calculation of pseudotime of each cell.</p>
<p><code>Cytotree</code> provides a convenient way to calculate pseudotime.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="analysis.html#cb88-1" aria-hidden="true"></a><span class="co"># Set HSPCs as root cells</span></span>
<span id="cb88-2"><a href="analysis.html#cb88-2" aria-hidden="true"></a>cyt &lt;-<span class="st"> </span><span class="kw">defRootCells</span>(cyt, <span class="dt">root.cells =</span> <span class="kw">c</span>(<span class="dv">36</span>,<span class="dv">89</span>,<span class="dv">11</span>))</span>
<span id="cb88-3"><a href="analysis.html#cb88-3" aria-hidden="true"></a>cyt &lt;-<span class="st"> </span><span class="kw">runPseudotime</span>(cyt, <span class="dt">dim.type =</span> <span class="st">&quot;raw&quot;</span>)</span></code></pre></div>
<p>And <code>Cytotree</code> provides a series of visualization functions to illustrate pseudotime.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="analysis.html#cb89-1" aria-hidden="true"></a><span class="co"># Rename stage in meta.data</span></span>
<span id="cb89-2"><a href="analysis.html#cb89-2" aria-hidden="true"></a>cyt<span class="op">@</span>meta.data<span class="op">$</span>stage &lt;-<span class="st"> </span>cyt<span class="op">@</span>meta.data<span class="op">$</span>branch.id</span>
<span id="cb89-3"><a href="analysis.html#cb89-3" aria-hidden="true"></a></span>
<span id="cb89-4"><a href="analysis.html#cb89-4" aria-hidden="true"></a><span class="co"># Visualization for pseudotime</span></span>
<span id="cb89-5"><a href="analysis.html#cb89-5" aria-hidden="true"></a><span class="kw">plot2D</span>(cyt, <span class="dt">item.use =</span> <span class="kw">c</span>(<span class="st">&quot;tSNE_1&quot;</span>, <span class="st">&quot;tSNE_2&quot;</span>), <span class="dt">category =</span> <span class="st">&quot;numeric&quot;</span>,</span>
<span id="cb89-6"><a href="analysis.html#cb89-6" aria-hidden="true"></a>       <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color.by =</span> <span class="st">&quot;pseudotime&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb89-7"><a href="analysis.html#cb89-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_colour_gradientn</span>(<span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;#F4D31D&quot;</span>, <span class="st">&quot;#FF3222&quot;</span>,<span class="st">&quot;#7A06A0&quot;</span>))</span></code></pre></div>
<p><img src="CytoTree-tutorial_files/figure-html/unnamed-chunk-30-1.png" width="50%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="analysis.html#cb90-1" aria-hidden="true"></a><span class="co"># Visualization for pseudotime in Tree</span></span>
<span id="cb90-2"><a href="analysis.html#cb90-2" aria-hidden="true"></a><span class="kw">plotTree</span>(cyt, <span class="dt">color.by =</span> <span class="st">&quot;pseudotime&quot;</span>, <span class="dt">cex.size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb90-3"><a href="analysis.html#cb90-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_colour_gradientn</span>(<span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;#F4D31D&quot;</span>,<span class="st">&quot;#FF3222&quot;</span>,<span class="st">&quot;#7A06A0&quot;</span>))</span></code></pre></div>
<p><img src="CytoTree-tutorial_files/figure-html/unnamed-chunk-30-2.png" width="50%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="analysis.html#cb91-1" aria-hidden="true"></a><span class="co"># Visualization for pseudotime density</span></span>
<span id="cb91-2"><a href="analysis.html#cb91-2" aria-hidden="true"></a><span class="kw">plotPseudotimeDensity</span>(cyt, <span class="dt">adjust =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="CytoTree-tutorial_files/figure-html/unnamed-chunk-31-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="analysis.html#cb92-1" aria-hidden="true"></a><span class="co"># Visualization for the correlation of pseudotime and markers</span></span>
<span id="cb92-2"><a href="analysis.html#cb92-2" aria-hidden="true"></a><span class="kw">plotPseudotimeTraj</span>(cyt, <span class="dt">var.cols =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb92-3"><a href="analysis.html#cb92-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_colour_gradientn</span>(<span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;#F4D31D&quot;</span>, <span class="st">&quot;#FF3222&quot;</span>,<span class="st">&quot;#7A06A0&quot;</span>))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="CytoTree-tutorial_files/figure-html/unnamed-chunk-31-2.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="intermediate-states" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Intermediate States</h2>
<p>After pseudotime estimation, all cells were reordered by pseudotime and the KNN network could be modified based on pseudotime. When the pseudotime of cell <em>i</em> was greater than cell <em>j</em>, the path from cell <em>i</em> to cell <em>j</em> could be accessed.</p>
<p>To calculate intermediate state cells, the leaf cells need to be defined first. The leaf cells were the terminal site of differentiation. During the biological process, the differentiation was always multidirectional. The intermediate state cells were the cells that occurred most likely in the shortest path between leaf cells and root cells based on the modified KNN network.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="analysis.html#cb94-1" aria-hidden="true"></a><span class="co">##### View Trajectory Tree</span></span>
<span id="cb94-2"><a href="analysis.html#cb94-2" aria-hidden="true"></a><span class="kw">plotTree</span>(cyt, <span class="dt">color.by =</span> <span class="st">&quot;branch.id&quot;</span>, <span class="dt">show.node.name =</span> <span class="ot">TRUE</span>, <span class="dt">cex.size =</span> <span class="dv">1</span>) </span></code></pre></div>
<p><img src="CytoTree-tutorial_files/figure-html/unnamed-chunk-32-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="analysis.html#cb95-1" aria-hidden="true"></a><span class="co">###### Intermediate state cells for CD8 T cells</span></span>
<span id="cb95-2"><a href="analysis.html#cb95-2" aria-hidden="true"></a>cyt &lt;-<span class="st"> </span><span class="kw">defLeafCells</span>(cyt, <span class="dt">leaf.cells =</span> <span class="kw">c</span>(<span class="dv">99</span>,<span class="dv">97</span>))</span>
<span id="cb95-3"><a href="analysis.html#cb95-3" aria-hidden="true"></a>cyt &lt;-<span class="st"> </span><span class="kw">runWalk</span>(cyt, <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 2020-11-08 20:00:58 Calculating walk between root.cells and leaf.cells .</code></pre>
<pre><code>## 2020-11-08 20:01:02 Generating an adjacency matrix.</code></pre>
<pre><code>## 2020-11-08 20:02:29 Walk forward.</code></pre>
<pre><code>## 2020-11-08 20:02:36 Calculating walk completed.</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="analysis.html#cb100-1" aria-hidden="true"></a>cyt<span class="op">@</span>meta.data<span class="op">$</span>traj.value.log.CD8T &lt;-<span class="st"> </span>cyt<span class="op">@</span>meta.data<span class="op">$</span>traj.value.log</span>
<span id="cb100-2"><a href="analysis.html#cb100-2" aria-hidden="true"></a></span>
<span id="cb100-3"><a href="analysis.html#cb100-3" aria-hidden="true"></a><span class="co">### fetch plot information</span></span>
<span id="cb100-4"><a href="analysis.html#cb100-4" aria-hidden="true"></a>plot.meta &lt;-<span class="st"> </span><span class="kw">fetchPlotMeta</span>(cyt, <span class="dt">markers =</span> <span class="kw">colnames</span>(cyt.data))</span>
<span id="cb100-5"><a href="analysis.html#cb100-5" aria-hidden="true"></a></span>
<span id="cb100-6"><a href="analysis.html#cb100-6" aria-hidden="true"></a><span class="co"># heatmap for CD8 T cells</span></span>
<span id="cb100-7"><a href="analysis.html#cb100-7" aria-hidden="true"></a><span class="kw">library</span>(pheatmap)</span>
<span id="cb100-8"><a href="analysis.html#cb100-8" aria-hidden="true"></a></span>
<span id="cb100-9"><a href="analysis.html#cb100-9" aria-hidden="true"></a>plot.meta.sub &lt;-<span class="st"> </span>plot.meta[<span class="kw">which</span>(plot.meta<span class="op">$</span>traj.value.log.CD8T <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>), ]</span>
<span id="cb100-10"><a href="analysis.html#cb100-10" aria-hidden="true"></a>plot.meta.sub &lt;-<span class="st"> </span>plot.meta.sub[<span class="kw">order</span>(plot.meta.sub<span class="op">$</span>pseudotime), ]</span>
<span id="cb100-11"><a href="analysis.html#cb100-11" aria-hidden="true"></a><span class="kw">pheatmap</span>(<span class="kw">t</span>(plot.meta.sub[, <span class="kw">colnames</span>(cyt.data)]), <span class="dt">scale  =</span> <span class="st">&quot;row&quot;</span>,</span>
<span id="cb100-12"><a href="analysis.html#cb100-12" aria-hidden="true"></a>         <span class="dt">cluster_rows =</span> T, <span class="dt">cluster_cols =</span> F, <span class="dt">cluster_method =</span> <span class="st">&quot;ward.D&quot;</span>,</span>
<span id="cb100-13"><a href="analysis.html#cb100-13" aria-hidden="true"></a>         <span class="dt">color =</span> <span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;red&quot;</span>))(<span class="dv">100</span>),</span>
<span id="cb100-14"><a href="analysis.html#cb100-14" aria-hidden="true"></a>         <span class="dt">fontsize_col =</span> <span class="fl">0.01</span>)</span></code></pre></div>
<p><img src="CytoTree-tutorial_files/figure-html/unnamed-chunk-32-2.png" width="70%" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ti.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="time-course-data-use-case.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
